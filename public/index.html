<!doctype html>
<html lang="es">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width,initial-scale=1"/>
<title>CS2 Premier Widget (csstats)</title>
<style>
  :root { --fg:#eaeaea; --muted:#9aa0a6; --accent:#4ade80; }
  * { box-sizing: border-box }
  body { margin:0; font:500 16px/1.2 system-ui,Segoe UI,Roboto,Arial; color:var(--fg); background:transparent }
  .card { display:flex; align-items:center; gap:12px;
    background: linear-gradient(135deg, rgba(15,15,18,.85), rgba(15,15,18,.55));
    border:1px solid rgba(255,255,255,.08); padding:14px 16px; border-radius:16px; backdrop-filter: blur(6px); }
  .avatar { width:48px; height:48px; border-radius:12px; object-fit:cover; border:1px solid rgba(255,255,255,.15); }
  .col { display:flex; flex-direction:column; gap:4px; }
  .name { font-size:15px; opacity:.95; }
  .rating { font-size:28px; font-weight:800; letter-spacing:.5px; }
  .sub { font-size:13px; color:var(--muted); }
  .footer { margin-left:auto; font-size:12px; color:var(--muted); display:flex; gap:8px; align-items:center }
  a { color:var(--accent); text-decoration:none; font-weight:700 }
</style>
</head>
<body>
  <div class="card">
    <img class="avatar" id="avatar" alt="avatar">
    <div class="col">
      <div class="name" id="name">Cargando…</div>
      <div class="rating" id="rating">—</div>
      <div class="sub" id="best">—</div>
      <div class="sub" id="season">—</div>
    </div>
    <div class="footer">
      <span>Data: </span><a id="src" target="_blank" rel="noopener">csstats.gg</a>
    </div>
  </div>

<script>
const STEAM_ID = "76561198844188625"; // tu SteamID64
const PROXY_URL = "/api/csstats/" + STEAM_ID;
// refresco prudente (5 min). Si quieres menos, 60–120s, pero mejor respetar ToS.
const REFRESH_MS = 5 * 60 * 1000;

async function load() {
  try {
    const r = await fetch(PROXY_URL, { cache: "no-store" });
    const d = await r.json();
    if (!r.ok) throw new Error(d?.error || `HTTP ${r.status}`);

    document.getElementById("name").textContent   = d.name || "Jugador";
    document.getElementById("avatar").src         = d.avatarUrl || "https://avatars.steamstatic.com/0000000000000000000000000000000000000000_full.jpg";
    document.getElementById("rating").textContent = d.rating ? d.rating.toLocaleString() : "—";
    document.getElementById("best").textContent   = d.bestRating ? `Mejor: ${d.bestRating.toLocaleString()}` : "Mejor: —";
    document.getElementById("season").textContent = d.season ? `Temporada: ${d.season}` : "Temporada: —";

    const a = document.getElementById("src");
    a.href = d.profileUrl || `https://csstats.gg/player/${STEAM_ID}`;
    a.textContent = "csstats.gg";
  } catch (err) {
    document.getElementById("name").textContent = "Error cargando datos";
    document.getElementById("rating").textContent = "—";
    document.getElementById("best").textContent = (err.message || "—").slice(0, 140);
    document.getElementById("season").textContent = "—";
    document.getElementById("src").href = `https://csstats.gg/player/${STEAM_ID}`;
  }
}

load();
setInterval(load, REFRESH_MS);
</script>
</body>
</html>
